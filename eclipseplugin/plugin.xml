<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
  
 <!-- Declaring commands -->
 <extension point="org.eclipse.ui.commands">
 	<category id="eclipseplugin.commands.category" name="eclipseplugin.commands.category.name">
 	</category>
 	
 	<command
 		categoryId="eclipseplugin.commands.category"
 		id="eclipseplugin.commands.configureCommand"
 		name="Modify configuration options and submit">
 	</command>
 	
 	<command
 		categoryId="eclipseplugin.commands.category"
 		id="eclipseplugin.commands.resubmitCommand"
 		name="Resubmit most recent assessment for active project">
 	</command>	
 	
 	<command
 		categoryId="eclipseplugin.commands.category"
 		id="eclipseplugin.commands.loginCommand"
 		name="Log in to SWAMP">
 	</command>	
 	
 	<command
 		categoryId="eclipseplugin.commands.category"
 		id="eclipseplugin.commands.logoutCommand"
 		name="Log out of SWAMP">
 	</command>	
 	
 	<command
 		categoryId="eclipseplugin.commands.category"
 		id="eclipseplugin.commands.pulldownCommand"
 		name="Pulldown">
 	</command>		
 	
 	<command
  		categoryId="eclipseplugin.commands.category"
  		id="eclipseplugin.commands.rightClickCommand"
  		name="Resubmit most recent assessment of this project">
  	</command>
  	
  	<command
  		categoryId="eclipseplugin.commands.category"
  		id="eclipseplugin.commands.aboutSwampCommand"
  		name="About SWAMP">
  	</command>
 		
 </extension>	

 <!-- Adding image to pulldown command -->
 <extension point="org.eclipse.ui.commandImages">
  	<image 
  		commandId="eclipseplugin.commands.pulldownCommand"
  		icon="icons/swamp-logo-square-height-20.png">
  	</image>
  </extension>  
  
 <!-- Associating handlers with the commands -->
 <extension point="org.eclipse.ui.handlers">
 	<handler
 		class="eclipseplugin.handlers.ConfigureHandler"
 		commandId="eclipseplugin.commands.configureCommand">
 	</handler>
 	
 	<handler
 		class="eclipseplugin.handlers.ResubmitHandler"
 		commandId="eclipseplugin.commands.resubmitCommand">
 	</handler>
 	
 	<handler
 		class="eclipseplugin.handlers.LoginHandler"
 		commandId="eclipseplugin.commands.loginCommand">
 		<enabledWhen>
 			<not>
 				<test property="eclipseplugin.properties.loggedIn">
 				</test>
 			</not>
 		</enabledWhen>
 	</handler>
  
  	<handler
 		class="eclipseplugin.handlers.LogoutHandler"
 		commandId="eclipseplugin.commands.logoutCommand">
 		<enabledWhen>
 			<test property="eclipseplugin.properties.loggedIn">
 			</test>
 		</enabledWhen>
 	</handler>
  	
  	<handler
 		class="eclipseplugin.handlers.ResubmitHandler"
 		commandId="eclipseplugin.commands.pulldownCommand">
 	</handler>
 	
 	<handler
 		class="eclipseplugin.handlers.RightClickHandler"
 		commandId="eclipseplugin.commands.rightClickCommand">
  	</handler>
  	
  	<handler
  		class="eclipseplugin.handlers.AboutSwampHandler"
  		commandId="eclipseplugin.commands.aboutSwampCommand">
  	</handler>
 </extension>
  
 <!-- Adding to menus -->
 <extension point="org.eclipse.ui.menus">
 	<!-- SWAMP Button and dropdown -->
 	<menuContribution locationURI="toolbar:org.eclipse.ui.main.toolbar?after=additions">
 		<toolbar
  			id="eclipseplugin.toolbars.swampToolbar">
  			<command
  				commandId="eclipseplugin.commands.pulldownCommand"
  				label="SWAMP Button"
  				tooltip="Resubmit Previous Assessment"
  				style="pulldown"
  				id="eclipseplugin.commands.swampButton">
  			</command>
  		</toolbar>
  	</menuContribution>
  	
  	<menuContribution locationURI="menu:eclipseplugin.commands.swampButton">
  		<command
  			commandId="eclipseplugin.commands.resubmitCommand"
  			label="Resubmit Previous Assessment"
  			mnemonic="R"
  			style="push">
  		</command>
  		<command
  			commandId="eclipseplugin.commands.configureCommand"
  			label="Configure Assessment Submission"
  			mnemonic="C"
  			style="push">
  		</command>
		<command
			commandId="eclipseplugin.commands.loginCommand"
			label="Log In"
			mnemonic="I"
			style="push">
		</command>
		<command
			commandId="eclipseplugin.commands.logoutCommand"
			label="Log Out"
			mnemonic="O"
			style="push">
		</command>
	</menuContribution>  			
	
	<!-- SWAMP Main Menu -->
	<menuContribution
       locationURI="menu:org.eclipse.ui.main.menu?after=additions">
    <menu
          id="eclipseplugin.menus.swampMenu"
          label="SWAMP"
          mnemonic="W">
      	<command
  			commandId="eclipseplugin.commands.resubmitCommand"
  			label="Resubmit Previous Assessment"
  			mnemonic="R"
  			style="push">
  		</command>
  		<command
  			commandId="eclipseplugin.commands.configureCommand"
  			label="Configure Assessment Submission"
  			mnemonic="C"
  			style="push">
  		</command>
  		<separator
  			name="separator-id"
  			visible="true">
  		</separator>	
		<command
			commandId="eclipseplugin.commands.loginCommand"
			label="Log In"
			mnemonic="I"
			style="push">
		</command>
		<command
			commandId="eclipseplugin.commands.logoutCommand"
			label="Log Out"
			mnemonic="O"
			style="push">
		</command> 
		<separator
			name="separator-id2"
			visible="true">
		</separator>	
		<command
			commandId="eclipseplugin.commands.aboutSwampCommand"
			label="About SWAMP"
			style="push">
		</command>
    </menu>
 </menuContribution>
 
 	<!-- Right Click Package Submission -->
 	<menuContribution
  		locationURI="popup:org.eclipse.jdt.ui.PackageExplorer">
  		<command
  			commandId="eclipseplugin.commands.rightClickCommand"
  			id="eclipseplugin.menus.rightClickCommand"
  			label="Assess Project on SWAMP"
  			mnemonic="A">
  			<visibleWhen
  				checkEnabled="false">
               	<with variable="activeMenuSelection">
               		<iterate ifEmpty="false">
               			<adapt type="org.eclipse.core.resources.IProject">
               				<test property="org.eclipse.core.resources.open" value="true" />
               			</adapt>
               		</iterate>
            	</with>
  			</visibleWhen>
  		</command>
  	</menuContribution>	
 </extension>
 
 <!-- Property tester for login/logout -->
 <extension point="org.eclipse.core.expressions.propertyTesters">
 	<propertyTester
 		class="eclipseplugin.handlers.LoginPropertyTester"
 		id="eclipseplugin.loginPropertyTester"
 		namespace="eclipseplugin.properties"
 		properties="loggedIn"
 		type="java.lang.Object">
 	</propertyTester>
 </extension>
 
 
 <!-- Class to trigger plug-in activation -->
 <extension point="org.eclipse.ui.startup">
 	<startup class="eclipseplugin.ActivationTriggerDummy">
 	</startup>
 </extension>
 
</plugin>     
